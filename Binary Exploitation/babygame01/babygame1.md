# **babygame1**

## **Overview:**
---
Category: Binary Exploitation

Points: 100

## **Description**
---
Get the flag and reach the exit.
Welcome to BabyGame! Navigate around the map and see what you can find! The game is available to download [here](https://artifacts.picoctf.net/c/222/game). There is no source available, so you'll have to figure your way around the map. You can connect with it using the port they give you.

## **Hints**
1. Use 'w','a','s','d' to move around.
2. There may be secret commands to make your life easy.

## **Approach**
Let's look at the code itself using IDA to decompile it.
```
int __cdecl main(int argc, const char **argv, const char **envp)
{
  char v4; // [esp+1h] [ebp-AA5h]
  int v5[2]; // [esp+2h] [ebp-AA4h] BYREF
  char v6; // [esp+Ah] [ebp-A9Ch]
  char v7[2700]; // [esp+Eh] [ebp-A98h] BYREF
  unsigned int v8; // [esp+A9Ah] [ebp-Ch]
  int *p_argc; // [esp+A9Eh] [ebp-8h]

  p_argc = &argc;
  v8 = __readgsdword(0x14u);
  init_player(v5);
  init_map(v7, v5);
  print_map(v7, v5);
  signal(2, sigint_handler);
  do
  {
    do
    {
      v4 = getchar(p_argc);
      move_player(v5, v4, v7);
      print_map(v7, v5);
    }
    while ( v5[0] != 29 );
  }
  while ( v5[1] != 89 );
  puts("You win!");
  if ( v6 )
  {
    puts("flage");
    win();
    fflush(stdout);
  }
  return 0;
}
```
Look like we have to somehow change the value of v6 which is the value of "Player has flag" line.

So i tried to perfom a buffer overflow by moving out of the map so that you don't get existed in the game before finishing it. And it worked.

Firstly, move the player to Player position: 0 0 and then using 'a' move your player to go off map a till you see that the flag have changed from 0 to 46 or 64.

Then move to the X position and get the flag.

## **Flag**
---
>**picoCTF{gamer_m0d3_enabled_054c1d5a}**